# Лабораторная работа №8: VxLAN. Routing.

## Цели работы
- Реализовать передачу суммарных префиксов через EVPN route-type 5
- Настроить маршрутизацию между клиентами через внешнее устройство
- Проверить связанность между клиентами

## Выполнение работы

### 1. Топология сети
![Логическая схема сети с обозначением AS](https://github.com/lixadei/Otuslabs/blob/main/lab8/VxLAN.%20Routing-topo.png)

*Рисунок 1. Архитектура Underlay сети (AS 65000-65003) с выделенными:*
- **Spine-устройствами** (AS 65000) - обеспечивают транспортную сеть между Leaf-ами
- **Leaf-устройствами** (AS 65001-65003) - выполняют функции VTEP (VXLAN Tunnel End Point)
- **Клиенты PC** - подключены к различным Leaf в разных VRF
- **Граничный роутер (bb)** - внешнее устройство

### 2. Конфигурация оборудования
Полные конфигурации оборудования доступны в приложенных файлах (конфигурация spine без изменений)

### 3. Анализ работоспособности BGP EVPN VXLAN инфраструктуры

#### 3.1. Проверка на Leaf1 (AS 65001)

##### Проверка таблицы маршрутизации VRF
![leaf1#show ip route vrf OTUS-Vxlan](https://github.com/user-attachments/assets/c092e898-ea96-4c12-930e-3e5cf8908bfb)
- Вывод таблицы маршрутизации VRF OTUS-Vxlan
- Наличие маршрутов ко всем клиентским подсетям через VXLAN

#### 3.2. Проверка на Leaf2 (AS 65002)

##### Проверка таблицы маршрутизации VRF
![leaf2#show ip route vrf OTUS-Vxlan](https://github.com/user-attachments/assets/286f6f19-3080-4a37-bd57-e7402eb12c52)
- Вывод таблицы маршрутизации VRF OTUS-Vxlan
- Наличие маршрутов ко всем клиентским подсетям через VXLAN

#### 3.3. Проверка на Leaf3 (AS 65003)

##### Проверка таблицы маршрутизации VRF
![leaf3#show ip route vrf OTUS-Vxlan](https://github.com/user-attachments/assets/b46aeb80-0cf9-4dbb-afe3-201c5a850ddf)
- Вывод таблицы маршрутизации VRF OTUS-Vxlan
- Наличие маршрутов ко всем клиентским подсетям через VXLAN

##### Проверка EVPN Type 5 (IP Prefix) маршрутов
![leaf1#show bgp evpn route-type  ip-prefix ipv4](https://github.com/user-attachments/assets/01b41d70-ed6e-4eff-950a-92e51c2bf98b)
- Подтверждение анонсирования префиксов через EVPN route-type 5

##### Проверка состояния VXLAN интерфейса
![leaf1#show interfaces vxlan 1](https://github.com/user-attachments/assets/b0879cc0-51f1-4d32-b245-136a0ce85857)
- Состояние VXLAN интерфейса
- Проверка корректной работы VXLAN туннеля

### 4. Проверка связности

#### Проверка связности между клиентами

##### Ping-тесты с PC1

![Ping результаты с pc1](https://github.com/user-attachments/assets/5240933b-60f2-44fd-9008-b31add356d4e)

| Источник | Назначение | Результат  |
|----------|------------|------------|
| PC1      | PC2        | Успешно    |
| PC1      | PC3        | Успешно    |
| PC1      | PC4        | Успешно    |
| PC1      | PC5        | Успешно    |
| PC1      | PC6        | Успешно    |
| PC1      | bb lo1     | Успешно    |

##### Ping-тесты с PC4

![Ping результаты с pc4](https://github.com/user-attachments/assets/20ec07b9-caa5-4911-a5f5-f5937a87e4d8)

| Источник | Назначение | Результат  |
|----------|------------|------------|
| PC4      | bb lo1     | Успешно    |
| PC4      | PC2        | Успешно    | 
| PC4      | PC3        | Успешно    |
| PC4      | PC5        | Успешно    |
| PC4      | PC6        | Успешно    |

**Вывод:**  
- Успешно реализована передача суммарных префиксов через EVPN route-type 5 между всеми Leaf-устройствами
- Все клиентские префиксы корректно анонсируются в Overlay сети через BGP EVPN
- Полная связность между всеми клиентскими устройствами и внешним роутером подтверждена ping-тестами
