# Лабораторная работа №8: VxLAN. Routing.

## Цели работы
- Реализовать передачу суммарных префиксов через EVPN route-type 5
- Настроить маршрутизацию между клиентами через внешнее устройство
- Проверить связанность между клиентами

## Выполнение работы

### 1. Топология сети
![Логическая схема сети с обозначением AS](https://github.com/lixadei/Otuslabs/blob/main/lab8/VxLAN.%20Routing-topo.png)

*Рисунок 1. Архитектура Underlay сети (AS 65000-65003) с выделенными:*
- **Spine-устройствами** (AS 65000) - обеспечивают транспортную сеть между Leaf-ами
- **Leaf-устройствами** (AS 65001-65003) - выполняют функции VTEP (VXLAN Tunnel End Point)
- **Клиенты PC** - подключены к различным Leaf в разных VLAN
- **Граничный роутер (bb)** - внешнее устройство

### 2. Конфигурация оборудования
Полные конфигурации оборудования доступны в приложенных файлах (конфигурация spine без изменений)

### 3. Анализ работоспособности BGP EVPN VXLAN инфраструктуры

#### 3.1. Проверка на Leaf1 (AS 65001)

##### Проверка таблицы маршрутизации VRF
![leaf1#show ip route vrf OTUS-Vxlan](https://github.com/user-attachments/assets/5d2b8204-73ab-4dbd-a229-45fe21f9a695)
- Вывод таблицы маршрутизации VRF OTUS-Vxlan
- Наличие маршрутов ко всем клиентским подсетям через VXLAN

#### 3.2. Проверка на Leaf2 (AS 65002)

##### Проверка таблицы маршрутизации VRF
![leaf2#show ip route vrf OTUS-Vxlan](https://github.com/user-attachments/assets/27aa9aae-b0cc-43d0-a32c-4859dd5b7e70)
- Вывод таблицы маршрутизации VRF OTUS-Vxlan
- Наличие маршрутов ко всем клиентским подсетям через VXLAN

#### 3.3. Проверка на Leaf3 (AS 65003)

##### Проверка таблицы маршрутизации VRF
![leaf3#show ip route vrf OTUS-Vxlan](https://github.com/user-attachments/assets/fbc33b20-b046-4603-a1f9-7e42932bea1d)
- Вывод таблицы маршрутизации VRF OTUS-Vxlan
- Наличие маршрутов ко всем клиентским подсетям через VXLAN

##### Проверка EVPN Type 5 (IP Prefix) маршрутов
![leaf1#show bgp evpn route-type  ip-prefix ipv4](https://github.com/user-attachments/assets/f6325fc8-3887-4dd4-8f62-be378141ac95)
- Подтверждение анонсирования префиксов через EVPN route-type 5

##### Проверка состояния VXLAN интерфейса
![leaf1#show interfaces vxlan 1](https://github.com/user-attachments/assets/538b0bd1-9a23-4305-b95c-8958ee1d6a80)
- Состояние VXLAN интерфейса
- Проверка корректной работы VXLAN туннеля

### 4. Проверка связности

#### Распределение клиентов по VLAN:
- VLAN10 - leaf1  
- VLAN11 - leaf2  
- VLAN12 - leaf3  

#### Проверка связности между клиентами

##### Ping-тесты с PC1

![Ping результаты с pc1](https://github.com/user-attachments/assets/d2fa438b-132c-4258-bd12-4aa45b177b4d)

| Источник | Назначение | Результат  |
|----------|------------|------------|
| PC1      | PC2        | Успешно    |
| PC1      | PC3        | Успешно    |
| PC1      | PC4        | Успешно    |
| PC1      | bb lo1     | Успешно    |

##### Ping-тесты с PC4

![Ping результаты с pc4](https://github.com/user-attachments/assets/f09e8506-2315-428a-9230-225b4c67893d)

| Источник | Назначение | Результат  |
|----------|------------|------------|
| PC4      | PC2        | Успешно    | 
| PC4      | PC3        | Успешно    |
| PC4      | bb lo1     | Успешно    |

**Вывод:**  
- Успешно реализована передача суммарных префиксов через EVPN route-type 5 между всеми Leaf-устройствами
- Все клиентские префиксы корректно анонсируются в Overlay сети через BGP EVPN
- Полная связность между всеми клиентскими устройствами и внешним роутером подтверждена ping-тестами
